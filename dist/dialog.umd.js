(function(a,b){'object'==typeof exports&&'undefined'!=typeof module?module.exports=b():'function'==typeof define&&define.amd?define(b):a.dialog=b()})(this,function(){'use strict';function a(){var a=Object.create(null);return{on:function(b,c){if(b&&c){var d=a[b]=a[b]||[];-1==d.indexOf(c)&&d.push(c)}},off:function(b){var c=1<arguments.length&&arguments[1]!==void 0&&arguments[1];c?a[b].splice(a[b].indexOf(c),1):delete a[b]},emit:function(b){for(var c=arguments.length,d=Array(1<c?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];(a[b]||[]).forEach(function(a){return a.apply(a,d)})}}}function b(a){var b=!(a.offsetWidth||a.offsetHeight||a.getClientRects().length),c='hidden'===window.getComputedStyle(a).visibility;return!(b||c)}function c(a){return[].concat(j(a.querySelectorAll(k))).filter(function(a){return b(a)})}function d(a){a&&a.focus&&a.focus()}function e(a){var b=c(a);b.length&&d(b[0])}function f(a,b){var e=document.activeElement,f=c(a),g=f[0],h=f[f.length-1];b.shiftKey&&e===g&&(d(h),b.preventDefault()),b.shiftKey||e!==h||(d(g),b.preventDefault())}function g(a,b){function c(b){var c=!a.contains(document.activeElement);b.preventDefault(),b.stopImmediatePropagation(),c&&i&&e(a)}function g(b){'Tab'===b.key&&f(a,b)}var h,i=!1;return{activate:function(){i||(i=!0,h=document.activeElement,b&&a.contains(b)?d(b):e(a),document.addEventListener('focus',c,!0),document.addEventListener('keydown',g,!0))},deactivate:function(){i&&(i=!1,d(h),h=void 0,document.removeEventListener('focus',c,!0),document.removeEventListener('keydown',g,!0))}}}function h(b,c,d){function e(a){'Escape'===a.key&&j()}function f(){var a=n.alert?'alertdialog':'dialog',b=document.getElementById(n.label),c=b?'labeledby':'label';if(l.dialog.setAttribute('role',a),l.dialog.setAttribute('aria-modal',!0),l.dialog.setAttribute('aria-'+c,n.label),document.getElementById(n.description))l.dialog.setAttribute('aria-describedby',n.description);else if(n.description)throw new Error('Invalid element: No element with the id "'+n.description+'"');q=!0,m.emit('create',l.dialog)}function h(){p||!q||(p=!0,l.dialog.classList.add(n.openClass),m.emit('open',l.dialog),document.addEventListener('keydown',e,!0),o.activate())}function j(){p&&q&&(o.deactivate(),p=!1,document.removeEventListener('keydown',e,!0),l.dialog.classList.remove(n.openClass),m.emit('close',l.dialog))}function k(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!p;a?h():j()}var l={main:document.getElementById(c),dialog:document.getElementById(b)},m=a();if(!l.dialog)throw new Error('No element with the id "'+b+'"');if(!l.main)throw new Error('No element with the id "'+c+'"');var n=Object.assign({},i,d),o=g(l.dialog,n.focus),p=!1,q=!1;return n.autoInit&&f(),{elements:l,create:f,destroy:function(){j(),q=!1,['aria-describedby','aria-label','aria-labeledby','aria-modal','role'].forEach(function(a){return l.dialog.removeAttribute(a)}),m.emit('destroy',l.dialog)},open:h,close:j,toggle:k,isOpen:p,on:m.on,off:m.off}}var i={label:'Dialog',description:'',focus:'',alert:!1,openClass:'is-open',autoInit:!0},j=function(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)},k=['[contenteditable]','[tabindex]:not([tabindex^="-"])','a[href]','area[href]','button:not([disabled])','embed','iframe','input:not([disabled])','object','select:not([disabled])','textarea:not([disabled])'];return h});
