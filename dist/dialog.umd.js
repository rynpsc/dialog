(function(a,b){'object'==typeof exports&&'undefined'!=typeof module?module.exports=b():'function'==typeof define&&define.amd?define(b):a.dialog=b()})(this,function(){'use strict';function a(a,b){if(a&&b){var c=l[a]=l[a]||[];-1==c.indexOf(b)&&c.push(b)}}function b(a){var b=1<arguments.length&&arguments[1]!==void 0&&arguments[1];b?l[a].splice(l[a].indexOf(b),1):delete l[a]}function c(a){for(var b=arguments.length,c=Array(1<b?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];(l[a]||[]).forEach(function(a){return a.apply(a,c)})}function d(a){var b=!(a.offsetWidth||a.offsetHeight||a.getClientRects().length),c='hidden'===window.getComputedStyle(a).visibility;return!(b||c)}function e(a){return[].concat(m(a.querySelectorAll(n))).filter(function(a){return d(a)})}function f(a){a&&a.focus&&a.focus()}function g(a){var b=e(a);b.length&&f(b[0])}function h(a,b){var c=document.activeElement,d=e(a),g=d[0],h=d[d.length-1];b.shiftKey&&c===g&&(f(h),b.preventDefault()),b.shiftKey||c!==h||(f(g),b.preventDefault())}function i(a,b){function c(b){var c=!a.contains(document.activeElement);b.preventDefault(),b.stopImmediatePropagation(),c&&i&&g(a)}function d(b){'Tab'===b.key&&h(a,b)}var e,i=!1;return{activate:function(){i||(i=!0,e=document.activeElement,b&&a.contains(b)?f(b):g(a),document.addEventListener('focus',c,!0),document.addEventListener('keydown',d,!0))},deactivate:function(){i&&(i=!1,f(e),e=void 0,document.removeEventListener('focus',c,!0),document.removeEventListener('keydown',d,!0))}}}function j(d,e,f){function g(a){'Escape'===a.key&&l()}function h(){var a=o.alert?'alertdialog':'dialog',b=document.getElementById(o.label),d=b?'labeledby':'label';if(n.dialog.setAttribute('role',a),n.dialog.setAttribute('aria-modal',!0),n.dialog.setAttribute('aria-'+d,o.label),document.getElementById(o.description))n.dialog.setAttribute('aria-describedby',o.description);else if(o.description)throw new Error('Invalid element: No element with the id "'+o.description+'"');r=!0,c('create',n.dialog)}function j(){q||!r||(q=!0,n.dialog.classList.add(o.openClass),c('open',n.dialog),document.addEventListener('keydown',g,!0),p.activate())}function l(){q&&r&&(p.deactivate(),q=!1,document.removeEventListener('keydown',g,!0),n.dialog.classList.remove(o.openClass),c('close',n.dialog))}function m(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!q;a?j():l()}var n={main:document.getElementById(e),dialog:document.getElementById(d)};if(!n.dialog)throw new Error('No element with the id "'+d+'"');if(!n.main)throw new Error('No element with the id "'+e+'"');var o=Object.assign({},k,f),p=i(n.dialog,o.focus),q=!1,r=!1;return o.autoInit&&h(),{elements:n,create:h,destroy:function(){l(),r=!1,['aria-describedby','aria-label','aria-labeledby','aria-modal','role'].forEach(function(a){return n.dialog.removeAttribute(a)}),c('destroy',n.dialog)},open:j,close:l,toggle:m,isOpen:q,on:a,off:b}}var k={label:'Dialog',description:'',focus:'',alert:!1,openClass:'is-open',autoInit:!0},l=Object.create(null),m=function(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)},n=['[contenteditable]','[tabindex]:not([tabindex^="-"])','a[href]','area[href]','button:not([disabled])','embed','iframe','input:not([disabled])','object','select:not([disabled])','textarea:not([disabled])'];return j});
