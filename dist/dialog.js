var defaults={label:'Dialog',description:'',focus:'',alert:!1,openClass:'is-open',autoInit:!0},events=Object.create(null);function on(a,b){if(a&&b){var c=events[a]=events[a]||[];-1==c.indexOf(b)&&c.push(b)}}function off(a){var b=1<arguments.length&&arguments[1]!==void 0&&arguments[1];b?events[a].splice(events[a].indexOf(b),1):delete events[a]}function emit(a){for(var b=arguments.length,c=Array(1<b?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];(events[a]||[]).forEach(function(a){return a.apply(a,c)})}var toConsumableArray=function(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)},selectors=['[contenteditable]','[tabindex]:not([tabindex^="-"])','a[href]','area[href]','button:not([disabled])','embed','iframe','input:not([disabled])','object','select:not([disabled])','textarea:not([disabled])'];function isVisible(a){var b=!(a.offsetWidth||a.offsetHeight||a.getClientRects().length),c='hidden'===window.getComputedStyle(a).visibility;return!(b||c)}function getFocusableElements(a){return[].concat(toConsumableArray(a.querySelectorAll(selectors))).filter(function(a){return isVisible(a)})}function focus(a){a&&a.focus&&a.focus()}function focusFirstElement(a){var b=getFocusableElements(a);b.length&&focus(b[0])}function trapTab(a,b){var c=document.activeElement,d=getFocusableElements(a),e=d[0],f=d[d.length-1];b.shiftKey&&c===e&&(focus(f),b.preventDefault()),b.shiftKey||c!==f||(focus(e),b.preventDefault())}function focusTrap(a,b){function c(b){var c=!a.contains(document.activeElement);b.preventDefault(),b.stopImmediatePropagation(),c&&f&&focusFirstElement(a)}function d(b){'Tab'===b.key&&trapTab(a,b)}var e,f=!1;return{activate:function(){f||(f=!0,e=document.activeElement,b&&a.contains(b)?focus(b):focusFirstElement(a),document.addEventListener('focus',c,!0),document.addEventListener('keydown',d,!0))},deactivate:function(){f&&(f=!1,focus(e),e=void 0,document.removeEventListener('focus',c,!0),document.removeEventListener('keydown',d,!0))}}}function dialog(a,b,c){function d(a){'Escape'===a.key&&g()}function e(){var a=j.alert?'alertdialog':'dialog',b=document.getElementById(j.label),c=b?'labeledby':'label';if(i.dialog.setAttribute('role',a),i.dialog.setAttribute('aria-modal',!0),i.dialog.setAttribute('aria-'+c,j.label),document.getElementById(j.description))i.dialog.setAttribute('aria-describedby',j.description);else if(j.description)throw new Error('Invalid element: No element with the id "'+j.description+'"');m=!0,emit('create',i.dialog)}function f(){l||!m||(l=!0,i.dialog.classList.add(j.openClass),emit('open',i.dialog),document.addEventListener('keydown',d,!0),k.activate())}function g(){l&&m&&(k.deactivate(),l=!1,document.removeEventListener('keydown',d,!0),i.dialog.classList.remove(j.openClass),emit('close',i.dialog))}function h(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!l;a?f():g()}var i={main:document.getElementById(b),dialog:document.getElementById(a)};if(!i.dialog)throw new Error('No element with the id "'+a+'"');if(!i.main)throw new Error('No element with the id "'+b+'"');var j=Object.assign({},defaults,c),k=focusTrap(i.dialog,j.focus),l=!1,m=!1;return j.autoInit&&e(),{elements:i,create:e,destroy:function(){g(),m=!1,['aria-describedby','aria-label','aria-labeledby','aria-modal','role'].forEach(function(a){return i.dialog.removeAttribute(a)}),emit('destroy',i.dialog)},open:f,close:g,toggle:h,isOpen:l,on:on,off:off}}export default dialog;
