var defaults={label:'Dialog',description:'',focus:'',alert:!1,openClass:'is-open',autoInit:!0};function emitter(){var a=Object.create(null);return{on:function(b,c){if(b&&c){var d=a[b]=a[b]||[];-1==d.indexOf(c)&&d.push(c)}},off:function(b){var c=1<arguments.length&&arguments[1]!==void 0&&arguments[1];c?a[b].splice(a[b].indexOf(c),1):delete a[b]},emit:function(b){for(var c=arguments.length,d=Array(1<c?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];(a[b]||[]).forEach(function(a){return a.apply(a,d)})}}}var toConsumableArray=function(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)},selectors=['[contenteditable]','[tabindex]:not([tabindex^="-"])','a[href]','area[href]','button:not([disabled])','embed','iframe','input:not([disabled])','object','select:not([disabled])','textarea:not([disabled])'];function isVisible(a){var b=!(a.offsetWidth||a.offsetHeight||a.getClientRects().length),c='hidden'===window.getComputedStyle(a).visibility;return!(b||c)}function getFocusableElements(a){return[].concat(toConsumableArray(a.querySelectorAll(selectors))).filter(function(a){return isVisible(a)})}function focus(a){a&&a.focus&&a.focus()}function focusFirstElement(a){var b=getFocusableElements(a);b.length&&focus(b[0])}function trapTab(a,b){var c=document.activeElement,d=getFocusableElements(a),e=d[0],f=d[d.length-1];b.shiftKey&&c===e&&(focus(f),b.preventDefault()),b.shiftKey||c!==f||(focus(e),b.preventDefault())}function focusTrap(a,b){function c(b){var c=!a.contains(document.activeElement);b.preventDefault(),b.stopImmediatePropagation(),c&&f&&focusFirstElement(a)}function d(b){'Tab'===b.key&&trapTab(a,b)}var e,f=!1;return{activate:function(){f||(f=!0,e=document.activeElement,b&&a.contains(b)?focus(b):focusFirstElement(a),document.addEventListener('focus',c,!0),document.addEventListener('keydown',d,!0))},deactivate:function(){f&&(f=!1,focus(e),e=void 0,document.removeEventListener('focus',c,!0),document.removeEventListener('keydown',d,!0))}}}function dialog(a,b,c){function d(a){'Escape'===a.key&&g()}function e(){var a=k.alert?'alertdialog':'dialog',b=document.getElementById(k.label),c=b?'labeledby':'label';if(i.dialog.setAttribute('role',a),i.dialog.setAttribute('aria-modal',!0),i.dialog.setAttribute('aria-'+c,k.label),document.getElementById(k.description))i.dialog.setAttribute('aria-describedby',k.description);else if(k.description)throw new Error('Invalid element: No element with the id "'+k.description+'"');n=!0,j.emit('create',i.dialog)}function f(){m||!n||(m=!0,i.dialog.classList.add(k.openClass),j.emit('open',i.dialog),document.addEventListener('keydown',d,!0),l.activate())}function g(){m&&n&&(l.deactivate(),m=!1,document.removeEventListener('keydown',d,!0),i.dialog.classList.remove(k.openClass),j.emit('close',i.dialog))}function h(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!m;a?f():g()}var i={main:document.getElementById(b),dialog:document.getElementById(a)},j=emitter();if(!i.dialog)throw new Error('No element with the id "'+a+'"');if(!i.main)throw new Error('No element with the id "'+b+'"');var k=Object.assign({},defaults,c),l=focusTrap(i.dialog,k.focus),m=!1,n=!1;return k.autoInit&&e(),{elements:i,create:e,destroy:function(){g(),n=!1,['aria-describedby','aria-label','aria-labeledby','aria-modal','role'].forEach(function(a){return i.dialog.removeAttribute(a)}),j.emit('destroy',i.dialog)},open:f,close:g,toggle:h,isOpen:m,on:j.on,off:j.off}}export default dialog;
